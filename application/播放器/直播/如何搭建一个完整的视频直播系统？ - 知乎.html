<!doctype html>
<html lang="zh" data-reactroot="" data-reactid="1" data-react-checksum="555370505"><head data-reactid="2"><meta charset="utf-8" data-reactid="3"/><title data-react-helmet="true" data-reactid="4">如何搭建一个完整的视频直播系统？ - 知乎</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" data-reactid="5"/><meta name="renderer" content="webkit" data-reactid="6"/><meta name="force-rendering" content="webkit" data-reactid="7"/><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" data-reactid="8"/><meta name="google-site-verification" content="FTeR0c8arOPKh8c5DYh_9uu98_zJbaWw53J-Sch9MTg" data-reactid="9"/><meta data-react-helmet="true" name="apple-itunes-app" content="app-id=432274380, app-argument=zhihu://questions/42162310" data-reactid="10"/><link rel="shortcut icon" type="image/x-icon" href="https://static.zhihu.com/static/favicon.ico" data-reactid="11"/><link rel="dns-prefetch" href="//static.zhimg.com" data-reactid="12"/><link rel="dns-prefetch" href="//pic1.zhimg.com" data-reactid="13"/><link rel="dns-prefetch" href="//pic2.zhimg.com" data-reactid="14"/><link rel="dns-prefetch" href="//pic3.zhimg.com" data-reactid="15"/><link rel="dns-prefetch" href="//pic4.zhimg.com" data-reactid="16"/><link href="https://static.zhihu.com/heifetz/main.app.81439a7c0a3d5c8d7577.css" rel="stylesheet" data-reactid="17"/></head><body class="Entry-body" data-reactid="18"><div id="root" data-reactid="19"><div data-zop-userToken="{}"><div class="LoadingBar"></div><div><header role="banner" class="Sticky AppHeader" data-za-module="TopNavBar"><div class="AppHeader-inner"><a href="/" aria-label="知乎"><svg viewBox="0 0 200 91" class="Icon Icon--logo" style="fill:#0f88eb;height:30px;width:64px;" width="64" height="30" aria-hidden="true"><title></title><g><path d="M53.29 80.035l7.32.002 2.41 8.24 13.128-8.24h15.477v-67.98H53.29v67.978zm7.79-60.598h22.756v53.22h-8.73l-8.718 5.473-1.587-5.46-3.72-.012v-53.22zM46.818 43.162h-16.35c.545-8.467.687-16.12.687-22.955h15.987s.615-7.05-2.68-6.97H16.807c1.09-4.1 2.46-8.332 4.1-12.708 0 0-7.523 0-10.085 6.74-1.06 2.78-4.128 13.48-9.592 24.41 1.84-.2 7.927-.37 11.512-6.94.66-1.84.785-2.08 1.605-4.54h9.02c0 3.28-.374 20.9-.526 22.95H6.51c-3.67 0-4.863 7.38-4.863 7.38H22.14C20.765 66.11 13.385 79.24 0 89.62c6.403 1.828 12.784-.29 15.937-3.094 0 0 7.182-6.53 11.12-21.64L43.92 85.18s2.473-8.402-.388-12.496c-2.37-2.788-8.768-10.33-11.496-13.064l-4.57 3.627c1.363-4.368 2.183-8.61 2.46-12.71H49.19s-.027-7.38-2.372-7.38zm128.752-.502c6.51-8.013 14.054-18.302 14.054-18.302s-5.827-4.625-8.556-1.27c-1.874 2.548-11.51 15.063-11.51 15.063l6.012 4.51zm-46.903-18.462c-2.814-2.577-8.096.667-8.096.667s12.35 17.2 12.85 17.953l6.08-4.29s-8.02-11.752-10.83-14.33zM199.99 46.5c-6.18 0-40.908.292-40.953.292v-31.56c1.503 0 3.882-.124 7.14-.376 12.773-.753 21.914-1.25 27.427-1.504 0 0 3.817-8.496-.185-10.45-.96-.37-7.24 1.43-7.24 1.43s-51.63 5.153-72.61 5.64c.5 2.756 2.38 5.336 4.93 6.11 4.16 1.087 7.09.53 15.36.277 7.76-.5 13.65-.76 17.66-.76v31.19h-41.71s.88 6.97 7.97 7.14h33.73v22.16c0 4.364-3.498 6.87-7.65 6.6-4.4.034-8.15-.36-13.027-.566.623 1.24 1.977 4.496 6.035 6.824 3.087 1.502 5.054 2.053 8.13 2.053 9.237 0 14.27-5.4 14.027-14.16V53.93h38.235c3.026 0 2.72-7.432 2.72-7.432z" fill-rule="evenodd"/></g></svg></a><nav role="navigation" class="AppHeader-nav"><a class="AppHeader-navItem" href="/">首页</a><a class="AppHeader-navItem" href="/explore">发现</a><a class="AppHeader-navItem" href="/topic">话题</a></nav><div class="SearchBar" role="search"><div class="SearchBar-toolWrapper"><form class="SearchBar-tool"><div><div class="Popover"><div class="SearchBar-input Input-wrapper Input-wrapper--grey"><input type="text" maxlength="100" value="" autocomplete="off" role="combobox" aria-expanded="false" aria-autocomplete="list" aria-activedescendant="null--1" id="null-toggle" aria-haspopup="true" aria-owns="null-content" class="Input" placeholder="搜索你感兴趣的内容…"/><div class="Input-after"><button class="Button SearchBar-searchIcon Button--primary" aria-label="搜索" type="button"><svg viewBox="0 0 16 16" class="Icon Icon--search" style="height:16px;width:16px;" width="16" height="16" aria-hidden="true"><title></title><g><path d="M12.054 10.864c.887-1.14 1.42-2.57 1.42-4.127C13.474 3.017 10.457 0 6.737 0S0 3.016 0 6.737c0 3.72 3.016 6.737 6.737 6.737 1.556 0 2.985-.533 4.127-1.42l3.103 3.104c.765.46 1.705-.37 1.19-1.19l-3.103-3.104zm-5.317.925c-2.786 0-5.053-2.267-5.053-5.053S3.95 1.684 6.737 1.684 11.79 3.95 11.79 6.737 9.522 11.79 6.736 11.79z"/></g></svg></button></div></div></div></div></form></div></div><div class="AppHeader-userInfo"><div class="AppHeader-profile"><div><button class="Button AppHeader-login Button--blue" type="button">登录</button><button class="Button Button--primary Button--blue" type="button">加入知乎</button></div></div></div></div></header></div><main role="main" class="App-main"><div class="QuestionPage" itemscope="" itemtype="http://schema.org/Question"><meta itemprop="name" content="如何搭建一个完整的视频直播系统？"/><meta itemprop="url" content="https://www.zhihu.com/question/42162310"/><meta itemprop="keywords" content="视频直播,视频点播,网络主播,带宽管理"/><meta itemprop="answerCount" content="113"/><meta itemprop="commentCount" content="16"/><meta itemprop="dateCreated" content="2016-04-05T08:30:51.000Z"/><meta itemprop="dateModified" content="2016-04-05T08:30:51.000Z"/><meta itemprop="zhihu:visitsCount"/><meta itemprop="zhihu:followerCount" content="7629"/><div data-zop-question="{&quot;title&quot;:&quot;如何搭建一个完整的视频直播系统？&quot;,&quot;topics&quot;:[{&quot;name&quot;:&quot;视频直播&quot;,&quot;id&quot;:&quot;19581451&quot;},{&quot;name&quot;:&quot;视频点播&quot;,&quot;id&quot;:&quot;19617373&quot;},{&quot;name&quot;:&quot;网络主播&quot;,&quot;id&quot;:&quot;19649229&quot;},{&quot;name&quot;:&quot;带宽管理&quot;,&quot;id&quot;:&quot;19792905&quot;}],&quot;id&quot;:42162310,&quot;isEditable&quot;:false}"><div class="QuestionHeader"><div class="QuestionHeader-content"><div class="QuestionHeader-main"><div class="QuestionHeader-tags"><div class="QuestionHeader-topics"><div class="Tag QuestionTopic"><span class="Tag-content"><a class="TopicLink" href="/topic/19581451"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content">视频直播</div></div></a></span></div><div class="Tag QuestionTopic"><span class="Tag-content"><a class="TopicLink" href="/topic/19617373"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content">视频点播</div></div></a></span></div><div class="Tag QuestionTopic"><span class="Tag-content"><a class="TopicLink" href="/topic/19649229"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content">网络主播</div></div></a></span></div><div class="Tag QuestionTopic"><span class="Tag-content"><a class="TopicLink" href="/topic/19792905"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content">带宽管理</div></div></a></span></div></div></div><h1 class="QuestionHeader-title">如何搭建一个完整的视频直播系统？</h1><div class="QuestionHeader-detail"><div class="QuestionRichText QuestionRichText--expandable QuestionRichText--collapsed"><div><span class="RichText" itemprop="text">朋友打算打造一个全新模式的视频直播平台，主要功能有些类似现在很多的美女直播平台。假设前期同时在线观看人数为2W人，清晰度不低于720P，拥有美颜、混音等附加功能，还有最重要的不能卡顿。如果以上假设成立，需要做哪些准备工作，技术门槛有多高，资金支出要多少？</span><button class="Button QuestionRichText-more Button--plain" type="button">显示全部<svg viewBox="0 0 10 6" class="Icon QuestionRichText-more-icon Icon--arrow" style="height:16px;width:10px;" width="10" height="16" aria-hidden="true"><title></title><g><path d="M8.716.217L5.002 4 1.285.218C.99-.072.514-.072.22.218c-.294.29-.294.76 0 1.052l4.25 4.512c.292.29.77.29 1.063 0L9.78 1.27c.293-.29.293-.76 0-1.052-.295-.29-.77-.29-1.063 0z"/></g></svg></button></div></div></div></div><div class="QuestionHeader-side"><div class="QuestionHeader-follow-status"><div class="QuestionFollowStatus"><div class="NumberBoard QuestionFollowStatus-counts"><div class="NumberBoard-item"><div class="NumberBoard-name">关注者</div><div class="NumberBoard-value">7629</div></div><div class="NumberBoard-divider"></div><div class="NumberBoard-item"><div class="NumberBoard-name">被浏览</div><div class="NumberBoard-value">267703</div></div></div></div></div></div></div><div class="QuestionHeader-footer"><div class="QuestionHeader-footer-inner"><div class="QuestionHeader-main QuestionHeader-footer-main"><div class="QuestionHeaderActions"><div class="QuestionHeader-Comment"><button class="Button Button--plain" type="button"><svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg" class="Icon Icon--comment Icon--left" style="height:15px;width:20px;" width="20" height="15" aria-hidden="true"><title></title><g><path d="M7.24 16.313c-.272-.047-.553.026-.77.2-1.106.813-2.406 1.324-3.77 1.482-.16.017-.313-.06-.394-.197-.082-.136-.077-.308.012-.44.528-.656.906-1.42 1.11-2.237.04-.222-.046-.45-.226-.588C1.212 13.052.027 10.73 0 8.25 0 3.7 4.03 0 9 0s9 3.7 9 8.25-4.373 9.108-10.76 8.063z"/></g></svg>16 条评论</button></div><div class="Popover ShareMenu"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><button class="Button Button--plain" type="button"><svg viewBox="0 0 20 18" xmlns="http://www.w3.org/2000/svg" class="Icon Icon--share Icon--left" style="height:16px;width:13px;" width="13" height="16" aria-hidden="true"><title></title><g><path d="M.93 3.89C-.135 4.13-.343 5.56.614 6.098L5.89 9.005l8.168-4.776c.25-.128.477.197.273.388L7.05 10.66l.926 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.243c.584-.892-.212-2.03-1.234-1.796L.93 3.89z"/></g></svg>分享</button></div></div><button class="Button Button--plain" type="button"><svg viewBox="0 0 20 20" class="Icon Icon--star Icon--left" style="height:16px;width:13px;" width="13" height="16" aria-hidden="true"><title></title><g><path d="M3.515 17.64l.918-5.355-3.89-3.792c-.926-.902-.64-1.784.64-1.97L6.56 5.74 8.964.87c.572-1.16 1.5-1.16 2.072 0l2.404 4.87 5.377.783c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.22 1.274-.532 1.82-1.676 1.218L10 16.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z"/></g></svg>邀请回答</button><div class="Popover"><button class="Button Button--plain" type="button" id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><svg viewBox="0 0 18 4" class="Icon Icon--dots" style="height:16px;width:14px;" width="14" height="16" aria-hidden="true"><title></title><g><g><circle cx="2" cy="2" r="2"/><circle cx="9" cy="2" r="2"/><circle cx="16" cy="2" r="2"/></g></g></svg></button></div></div><div class="QuestionHeader-actions"></div></div><div class="QuestionHeader-side"><div class="QuestionButtonGroup"><button class="Button Button--primary Button--blue" type="button">关注问题</button><button class="Button Button--blue" type="button"><svg viewBox="0 0 12 12" class="Icon Button-icon Icon--modify" style="height:16px;width:14px;" width="14" height="16" aria-hidden="true"><title></title><g><path d="M.423 10.32L0 12l1.667-.474 1.55-.44-2.4-2.33-.394 1.564zM10.153.233c-.327-.318-.85-.31-1.17.018l-.793.817 2.49 2.414.792-.814c.318-.328.312-.852-.017-1.17l-1.3-1.263zM3.84 10.536L1.35 8.122l6.265-6.46 2.49 2.414-6.265 6.46z" fill-rule="evenodd"/></g></svg>写回答</button></div></div></div></div></div><div><div><div class="Sticky"></div></div></div></div><div class="Question-main"><div class="Question-mainColumn"><div><div id="QuestionAnswers-answers" class="QuestionAnswers-answers"><div class="Card"><div class="List"><div class="List-header"><h4 class="List-headerText"><span>113 个回答</span></h4><div class="List-headerOptions"><div class="Popover"><button class="Button Select-button Select-plainButton Button--plain" role="combobox" aria-expanded="false" type="button" id="null-toggle" aria-haspopup="true" aria-owns="null-content">默认排序<svg viewBox="0 0 8 13" class="Icon Select-arrow Icon--select" style="height:16px;width:8px;" width="8" height="16" aria-hidden="true"><title></title><g><path d="M4 11.183L1.284 8.218c-.293-.29-.77-.29-1.064 0-.293.29-.293.76 0 1.052l3.25 3.512c.292.29.768.29 1.062 0L7.78 9.27c.293-.29.293-.76 0-1.052-.295-.29-.77-.29-1.064 0L4 11.182zM4 1.818L1.284 4.782c-.293.29-.77.29-1.064 0-.293-.29-.293-.76 0-1.052L3.47.218c.292-.29.768-.29 1.062 0L7.78 3.73c.293.29.293.76 0 1.052-.295.29-.77.29-1.064 0L4 1.82z"/></g></svg></button></div></div></div><div data-zop-feedlist="true"><div class="List-item"><div class="ContentItem AnswerItem" data-za-index="0" data-zop="{&quot;authorName&quot;:&quot;姚冬&quot;,&quot;itemId&quot;:93858266,&quot;title&quot;:&quot;如何搭建一个完整的视频直播系统？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="93858266" itemprop="acceptedAnswer" itemtype="http://schema.org/Answer" itemscope=""><div class="ContentItem-meta"><div class="AnswerItem-meta AnswerItem-meta--related"><div class="AuthorInfo" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="姚冬"/><meta itemprop="image" content="https://pic2.zhimg.com/v2-e579c26575f3f2b46450f0805a41ea91_is.jpg"/><meta itemprop="url" content="https://www.zhihu.com/people/yao-dong-27"/><meta itemprop="zhihu:followerCount" content="81435"/><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><a class="UserLink-link" data-za-detail-view-element_name="User" href="/people/yao-dong-27"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="https://pic2.zhimg.com/v2-e579c26575f3f2b46450f0805a41ea91_xs.jpg" srcset="https://pic2.zhimg.com/v2-e579c26575f3f2b46450f0805a41ea91_l.jpg 2x" alt="姚冬"/></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><a class="UserLink-link" data-za-detail-view-element_name="User" href="/people/yao-dong-27">姚冬</a></div></div><a class="UserLink-badge" href="/question/48509984" target="_blank" data-tooltip="优秀回答者"><svg viewBox="0 0 20 20" class="Icon Icon--badgeGlorious" style="height:16px;width:16px;" width="16" height="16" aria-hidden="true"><title>用户标识</title><g><g fill="none" fill-rule="evenodd">     <path d="M.64 11.39c1.068.895 1.808 2.733 1.66 4.113l.022-.196c-.147 1.384.856 2.4 2.24 2.278l-.198.016c1.387-.12 3.21.656 4.083 1.735l-.125-.154c.876 1.085 2.304 1.093 3.195.028l-.127.152c.895-1.068 2.733-1.808 4.113-1.66l-.198-.022c1.386.147 2.402-.856 2.28-2.238l.016.197c-.12-1.388.656-3.212 1.735-4.084l-.154.125c1.084-.876 1.093-2.304.028-3.195l.152.127c-1.068-.895-1.808-2.732-1.66-4.113l-.022.198c.147-1.386-.856-2.4-2.24-2.28l.198-.016c-1.387.122-3.21-.655-4.083-1.734l.125.153C10.802-.265 9.374-.274 8.483.79L8.61.64c-.895 1.068-2.733 1.808-4.113 1.662l.198.02c-1.386-.147-2.4.857-2.28 2.24L2.4 4.363c.12 1.387-.656 3.21-1.735 4.084l.154-.126C-.265 9.2-.274 10.626.79 11.517L.64 11.39z" fill="#FF9500"/>     <path d="M10.034 12.96L7.38 14.58c-.47.286-.747.09-.618-.45l.72-3.024-2.36-2.024c-.418-.357-.318-.68.235-.725l3.1-.25 1.195-2.87c.21-.508.55-.513.763 0l1.195 2.87 3.1.25c.547.043.657.365.236.725l-2.362 2.024.72 3.025c.13.535-.143.74-.616.45l-2.654-1.62z" fill="#FFF"/>   </g></g></svg></a></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="AuthorInfo-badgeText"><span><span><a href="/people/yao-dong-27/answers/topic/19552330">程序员</a>、</span><span><a href="/people/yao-dong-27/answers/topic/19554298">编程</a>、</span><span><a href="/people/yao-dong-27/answers/topic/19584970">C++</a> </span>话题</span>的优秀回答者</div></div></div></div></div><div class="AnswerItem-extraInfo"><span>收录于 <span class="AnswerItem-markInfoItem">编辑推荐</span></span> · <span class="Voters"><button class="Button Button--plain" type="button">2231 人赞同了该回答</button></span></div></div></div><meta itemprop="image" content=""/><meta itemprop="upvoteCount" content="2231"/><meta itemprop="url" content="https://www.zhihu.com/question/42162310/answer/93858266"/><meta itemprop="dateCreated" content="2016-04-05T15:55:07.000Z"/><meta itemprop="dateModified" content="2016-04-06T03:10:54.000Z"/><meta itemprop="commentCount" content="142"/><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText CopyrightRichText-richText" itemprop="text">视频直播，可以分为 采集，前处理，编码，传输，解码，渲染 这几个环节，下面分别说下：<br><br>采集，iOS是比较简单的，Android则要做些机型适配工作，PC最麻烦各种奇葩摄像头驱动，出了问题特别不好处理，建议放弃PC只支持手机主播，目前几个新进的直播平台都是这样的。<br><br>前处理，现在直播美颜已经是标配了，80%的主播没有美颜根本没法看。美颜算法需要用到GPU编程，需要懂图像处理算法的人，没有好的开源实现，要自己参考论文去研究。难点不在于美颜效果，而在于GPU占用和美颜效果之间找平衡。GPU虽然性能好，但是也是有功耗的，GPU占用太高会导致手机发烫，而手机发烫会导致摄像头采集掉帧，iPhone6尤其明显，因为iPhone6的CPU和前置摄像头很近。<br><br>编码，肯定要采用硬编码，软编码720p完全没希望，勉强能编码也会导致CPU过热烫到摄像头。硬编码兼容性又是一个大坑，android上要有人去填。编码要在分辨率，帧率，码率，GOP等参数设计上找到最佳平衡点。<br><br>传输，自己做不现实，交给CDN服务商吧，也就是贵了点，相信有志于做直播平台改变世界的你不差钱。假设2W PCU大约每月带宽费用100万左右，因为清晰流畅的720p要1.5mbps左右。CDN只提供了带宽和服务器间传输，发送和接收端的网络连接抖动缓冲还是要自己写的。不想要卡顿，必然要加大缓冲，会导致延迟高，延迟高影响互动性，要做权衡。<br><br>解码，也肯定要硬解码，目前手机普遍支持硬解了，只是android上还是有兼容性大坑要填。<br><br>渲染，这个难点不在于绘制，而在于音画同步，目前几个直播做得都不好。<br><br>此外音频还有几个坑要填，比如降噪，音频编码器的选择，各种蓝牙耳机，各种播放模式的适配等，如果你想做主播和观众连线聊天，还有个回声消除问题。<br><br>以上是媒体模块，还有信令控制，登录、鉴权、权限管理、状态管理等等，各种应用服务，消息推送，聊天，礼物系统，支付系统，运营支持系统，统计系统等。<br><br>后台还有数据库，缓存，分布式文件存储，消息队列，运维系统等。<br><br>这些显然不是一个程序员能解决的，如果真的有这样的高手，请联系我，无论你现在薪水多少，我都出两倍。<br><br>第一期至少要融资2000万RMB，组建至少10人的技术团队，10人的产品运营团队，争取3个月产品上线，半年达到5W在线（2w 根本不够）然后融资1个亿，或许还有希望一搏。<br><br>也许有人对带宽问题存疑，请参考欢聚时代15年四季度财报，带宽成本为人民币1.611亿元，折合每月5000+万，当然不能用这个数去推算在线人数，因为YY采购量很大所以带宽平均成本低，而且YY不只是高清直播，还有很大比例的500kbps左右码率的直播，还有相当一部分带宽是靠P2P解决的。总之带宽非常贵。<br><br>祝你朋友好运。</span></div><div><div class="ContentItem-time"><a target="_blank" href="/question/42162310/answer/93858266"><span data-tooltip="发布于 2016-04-05">编辑于 2016-04-06</span></a></div></div><div class="ContentItem-actions RichContent-actions"><span><button class="Button VoteButton VoteButton--up" aria-label="赞同" type="button"><svg viewBox="0 0 20 18" class="Icon VoteButton-upIcon Icon--triangle" style="height:16px;width:9px;" width="9" height="16" aria-hidden="true"><title></title><g><path d="M0 15.243c0-.326.088-.533.236-.896l7.98-13.204C8.57.57 9.086 0 10 0s1.43.57 1.784 1.143l7.98 13.204c.15.363.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H1.955c-1.08 0-1.955-.517-1.955-1.9z"/></g></svg>2.2K</button><button class="Button VoteButton VoteButton--down" aria-label="反对" type="button"><svg viewBox="0 0 20 18" class="Icon VoteButton-downIcon Icon--triangle" style="height:16px;width:9px;" width="9" height="16" aria-hidden="true"><title></title><g><path d="M0 15.243c0-.326.088-.533.236-.896l7.98-13.204C8.57.57 9.086 0 10 0s1.43.57 1.784 1.143l7.98 13.204c.15.363.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H1.955c-1.08 0-1.955-.517-1.955-1.9z"/></g></svg></button></span><button class="Button ContentItem-action Button--plain" type="button"><svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg" class="Icon Icon--comment Icon--left" style="height:16px;width:12px;" width="12" height="16" aria-hidden="true"><title></title><g><path d="M7.24 16.313c-.272-.047-.553.026-.77.2-1.106.813-2.406 1.324-3.77 1.482-.16.017-.313-.06-.394-.197-.082-.136-.077-.308.012-.44.528-.656.906-1.42 1.11-2.237.04-.222-.046-.45-.226-.588C1.212 13.052.027 10.73 0 8.25 0 3.7 4.03 0 9 0s9 3.7 9 8.25-4.373 9.108-10.76 8.063z"/></g></svg>142 条评论</button><div class="Popover ShareMenu ContentItem-action"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><button class="Button Button--plain" type="button"><svg viewBox="0 0 20 18" xmlns="http://www.w3.org/2000/svg" class="Icon Icon--share Icon--left" style="height:16px;width:13px;" width="13" height="16" aria-hidden="true"><title></title><g><path d="M.93 3.89C-.135 4.13-.343 5.56.614 6.098L5.89 9.005l8.168-4.776c.25-.128.477.197.273.388L7.05 10.66l.926 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.243c.584-.892-.212-2.03-1.234-1.796L.93 3.89z"/></g></svg>分享</button></div></div><button class="Button ContentItem-action Button--plain" type="button"><svg viewBox="0 0 20 20" class="Icon Icon--star Icon--left" style="height:16px;width:13px;" width="13" height="16" aria-hidden="true"><title></title><g><path d="M3.515 17.64l.918-5.355-3.89-3.792c-.926-.902-.64-1.784.64-1.97L6.56 5.74 8.964.87c.572-1.16 1.5-1.16 2.072 0l2.404 4.87 5.377.783c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.22 1.274-.532 1.82-1.676 1.218L10 16.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z"/></g></svg>收藏</button><button class="Button ContentItem-action Button--plain" type="button"><svg width="14" height="16" viewBox="0 0 20 18" xmlns="http://www.w3.org/2000/svg" class="Icon Icon--thank Icon--left" style="height:16px;width:14px;" aria-hidden="true"><title></title><g><path d="M0 5.437C0 2.505 2.294.094 5.207 0 7.243 0 9.092 1.19 10 3c.823-1.758 2.65-3 4.65-3C17.546 0 20 2.507 20 5.432 20 13.24 11.842 18 10 18 8.158 18 0 13.24 0 5.437z" fill-rule="evenodd"/></g></svg>感谢</button><button class="Button ContentItem-action ContentItem-rightButton Button--plain" data-zop-retract-question="true" type="button"><span class="RichContent-collapsedText">收起</span><svg viewBox="0 0 10 6" class="Icon ContentItem-arrowIcon is-active Icon--arrow" style="height:16px;width:10px;" width="10" height="16" aria-hidden="true"><title></title><g><path d="M8.716.217L5.002 4 1.285.218C.99-.072.514-.072.22.218c-.294.29-.294.76 0 1.052l4.25 4.512c.292.29.77.29 1.063 0L9.78 1.27c.293-.29.293-.76 0-1.052-.295-.29-.77-.29-1.063 0z"/></g></svg></button></div></div></div></div><div class="List-item"><div class="ContentItem AnswerItem" data-za-index="1" data-zop="{&quot;authorName&quot;:&quot;金山18667号码农&quot;,&quot;itemId&quot;:105746193,&quot;title&quot;:&quot;如何搭建一个完整的视频直播系统？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="105746193" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope=""><div class="ContentItem-meta"><div class="AnswerItem-meta AnswerItem-meta--related"><div class="AuthorInfo" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="金山18667号码农"/><meta itemprop="image" content="https://pic4.zhimg.com/6965601da36c92ae82390605f2e86337_is.jpg"/><meta itemprop="url" content="https://www.zhihu.com/people/zhu-zheng-35-16"/><meta itemprop="zhihu:followerCount" content="531"/><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><a class="UserLink-link" data-za-detail-view-element_name="User" href="/people/zhu-zheng-35-16"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="https://pic4.zhimg.com/6965601da36c92ae82390605f2e86337_xs.jpg" srcset="https://pic4.zhimg.com/6965601da36c92ae82390605f2e86337_l.jpg 2x" alt="金山18667号码农"/></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><a class="UserLink-link" data-za-detail-view-element_name="User" href="/people/zhu-zheng-35-16">金山18667号码农</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="RichText AuthorInfo-badgeText">码农</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button class="Button Button--plain" type="button">831 人赞同了该回答</button></span></div></div></div><meta itemprop="image" content="https://pic3.zhimg.com/305d29e8d0c2d3317d34286f2c75dcba_200x112.jpg"/><meta itemprop="upvoteCount" content="831"/><meta itemprop="url" content="https://www.zhihu.com/question/42162310/answer/105746193"/><meta itemprop="dateCreated" content="2016-06-13T06:21:09.000Z"/><meta itemprop="dateModified" content="2016-06-13T06:21:09.000Z"/><meta itemprop="commentCount" content="4"/><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText CopyrightRichText-richText" itemprop="text">技术点大家都回答的很详细了，我就我觉得视频直播系统中的一些难点再和大家分享下。<br><br><p>两年前我在做媒体云的时候，当时都是点播的业务。做到后面，我觉得点播业务其实并不像想象的那么难，你想你有一个稳定的存储，找一家靠谱的 CDN，然后找一个大概能用的播放器就做出来了，这有什么难的呢？你可以找云服务公司，也可以找外包，或者你自己招一个人都能做。但是现在发现到了移动，尤其是 3月份移动直播火起来之后，这个门槛突然变高了。因为内容产生方变成了移动端。从几个点来分析下为什么：</p><br><p><b>1 </b><b>、首先内容产生方就是推流端，</b>现在主流的 IOS、安卓，IOS比较简单，就是那个几个机型，基本大家适配都很好。但是安卓的碎片化是非常严重的，大量的精力都需要做对安卓的适配，而且软编耗电量普遍非常高，手机用了一会就会发烫，都担心会不会爆炸。用户体验就是在不同的网络情况下，上传的视频有可能会卡，有可能不连贯，报各种各样的错误，这个是作为一个开发者他自己不可能去适配的。说白了从用户那边提的需求就是推流端不能卡，画质要好，不能太烫，这是我们接触到的客户真正提的问题，是我们从有点偏技术的角度抽取出来的，它背后对应的是哪些事情。</p><p><b>2 </b><b>、然后是分发网络。</b>分发网络其实躲在一个很后面的地方，用户其实看不见的。真正对分发网络提需求用户也提不出来，所以基本这部分需求都会提给播放端，提的需求也是不能卡，不能花屏，首屏一定要快，一点就要看到，还不能把延时弄的太大。其实这些很多都是和源站分发网络有关系的，只是用户看不到这个需求会跟后面的播放器接在一起。</p><p>像首屏时间，就是用户点开就要看，以前那些开源架构就是 rtmp server，它是做不到一点开就能看的，现在一些开源的国内资源写得也比较好了，可以看到。我们是自己开发的，所以也花了一些工作，能保存之前的关键帧的信息，用户一点开就能看，这个就是很细节的东西了。如果这个做不好的话，会黑屏、绿屏，或者是半天看不着图像。</p><p><b>3、</b><b>在播放器这边也是我们在接业务的时候</b>，遇到用户投诉最多的，因为所有的问题都是在观看的时候体现的，所有的雷都得是播放器的同学去扛。这个需求也是不能卡，不能延迟太高。如果延迟高了，要追回来，追的时候声音不能变，最好是追的策略也能自己控制，这是用户真正提出来的需求。</p><br><p>要满足这些需求，我们需要做好多分辨率的适配，保证好流畅性，保证好我们追赶的策略不会出现任何异常。所以这三个端很多是相互耦合的，像推流和分发在一起，要保障好用户的流畅性和画质，分发和播放器在一起要保证好低延时和播放的流畅。所有的这些需求里共同的一点就是不能卡顿。</p><br><noscript><img src="https://pic3.zhimg.com/305d29e8d0c2d3317d34286f2c75dcba_b.jpg" data-rawwidth="803" data-rawheight="322" class="origin_image zh-lightbox-thumb" width="803" data-original="https://pic3.zhimg.com/305d29e8d0c2d3317d34286f2c75dcba_r.jpg"></noscript><img src="//zhstatic.zhihu.com/assets/zhihu/ztext/whitedot.jpg" data-rawwidth="803" data-rawheight="322" class="origin_image zh-lightbox-thumb lazy" width="803" data-original="https://pic3.zhimg.com/305d29e8d0c2d3317d34286f2c75dcba_r.jpg" data-actualsrc="https://pic3.zhimg.com/305d29e8d0c2d3317d34286f2c75dcba_b.jpg"><p>这个是我们的系统架构图。最下层是依托金山的云服务，因为我们已经有了很好的平台，提供了我们计算资源，提供了存储，提供了很多自建的节点，当然还不够多，我们还是个融合 CDN，然后提供了数据分析的能力。我们依托它做了橙色的这一层，就是我们自己的核心，流媒体直播，然后围绕这个核心我们在做的回看点播、在线转码、鉴权、内容审核。</p><br><p><b>1.回看点播：</b>因为这不是一个短视频录播的项目，而是一个直播，直播就决定它的并发不会很高，内容不会很多，热点比较少。如果你不回看的话，用户很难维持它的日活，很难维护用户黏度，所以用户一定会要求做回看的。</p><p><b>2.在线转码：</b>推流端其实做了很多把更好的画质想尽办法传上来的工作，投了很多人力来做。传上来之后，观看也在移动端，它不一定看得了。如果他看不了怎么办？我们就需要在线转，在线转码其实承担的更多更重要的事情。</p><p><b>3.鉴权：</b>用户都不想被盗链，尤其是推流的时候，如果我不鉴权，谁都可以来推。所以这是必须要有的</p><p><b>4.内容审核：</b>现在我们没有办法帮他做到自动审核，技术还不够。现在做到的是截图，按用户指定的时间定期截图，这样的话，用户就可以请一些外包来看是不是有敏感内容，是不是要下线，这个对于现在这种三四秒延迟的直播来说非常重要。你做不到的话，没准政策因素你就做不下去了。</p><p><b>5.数据分析：</b>一部分是依托金山已有的，一部分是我们自己做的，因为我们延迟性，时效性要求更高。客户会经常大半夜突然提出一个主播看起来特别卡，问你为什么，要是像以前那种方式，一个小时生成报表，然后出体验图，告诉他为什么卡了，客户可没有这个耐心。我们现在基本能做到5秒间隔就出之前的各种问题定位，这个定位包括从源站收集的数据画的曲线。还有从端上，如果端上用户允许的话，推流和拉流端我们都会有上报数据，几个曲线一拟合，我们就知道问题出在哪里。</p><br><p>利息相关：金山云架构师。</p></span></div><div><div class="ContentItem-time"><a target="_blank" href="/question/42162310/answer/105746193">发布于 2016-06-13</a></div></div><div class="ContentItem-actions RichContent-actions"><span><button class="Button VoteButton VoteButton--up" aria-label="赞同" type="button"><svg viewBox="0 0 20 18" class="Icon VoteButton-upIcon Icon--triangle" style="height:16px;width:9px;" width="9" height="16" aria-hidden="true"><title></title><g><path d="M0 15.243c0-.326.088-.533.236-.896l7.98-13.204C8.57.57 9.086 0 10 0s1.43.57 1.784 1.143l7.98 13.204c.15.363.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H1.955c-1.08 0-1.955-.517-1.955-1.9z"/></g></svg>831</button><button class="Button VoteButton VoteButton--down" aria-label="反对" type="button"><svg viewBox="0 0 20 18" class="Icon VoteButton-downIcon Icon--triangle" style="height:16px;width:9px;" width="9" height="16" aria-hidden="true"><title></title><g><path d="M0 15.243c0-.326.088-.533.236-.896l7.98-13.204C8.57.57 9.086 0 10 0s1.43.57 1.784 1.143l7.98 13.204c.15.363.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H1.955c-1.08 0-1.955-.517-1.955-1.9z"/></g></svg></button></span><button class="Button ContentItem-action Button--plain" type="button"><svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg" class="Icon Icon--comment Icon--left" style="height:16px;width:12px;" width="12" height="16" aria-hidden="true"><title></title><g><path d="M7.24 16.313c-.272-.047-.553.026-.77.2-1.106.813-2.406 1.324-3.77 1.482-.16.017-.313-.06-.394-.197-.082-.136-.077-.308.012-.44.528-.656.906-1.42 1.11-2.237.04-.222-.046-.45-.226-.588C1.212 13.052.027 10.73 0 8.25 0 3.7 4.03 0 9 0s9 3.7 9 8.25-4.373 9.108-10.76 8.063z"/></g></svg>4 条评论</button><div class="Popover ShareMenu ContentItem-action"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><button class="Button Button--plain" type="button"><svg viewBox="0 0 20 18" xmlns="http://www.w3.org/2000/svg" class="Icon Icon--share Icon--left" style="height:16px;width:13px;" width="13" height="16" aria-hidden="true"><title></title><g><path d="M.93 3.89C-.135 4.13-.343 5.56.614 6.098L5.89 9.005l8.168-4.776c.25-.128.477.197.273.388L7.05 10.66l.926 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.243c.584-.892-.212-2.03-1.234-1.796L.93 3.89z"/></g></svg>分享</button></div></div><button class="Button ContentItem-action Button--plain" type="button"><svg viewBox="0 0 20 20" class="Icon Icon--star Icon--left" style="height:16px;width:13px;" width="13" height="16" aria-hidden="true"><title></title><g><path d="M3.515 17.64l.918-5.355-3.89-3.792c-.926-.902-.64-1.784.64-1.97L6.56 5.74 8.964.87c.572-1.16 1.5-1.16 2.072 0l2.404 4.87 5.377.783c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.22 1.274-.532 1.82-1.676 1.218L10 16.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z"/></g></svg>收藏</button><button class="Button ContentItem-action Button--plain" type="button"><svg width="14" height="16" viewBox="0 0 20 18" xmlns="http://www.w3.org/2000/svg" class="Icon Icon--thank Icon--left" style="height:16px;width:14px;" aria-hidden="true"><title></title><g><path d="M0 5.437C0 2.505 2.294.094 5.207 0 7.243 0 9.092 1.19 10 3c.823-1.758 2.65-3 4.65-3C17.546 0 20 2.507 20 5.432 20 13.24 11.842 18 10 18 8.158 18 0 13.24 0 5.437z" fill-rule="evenodd"/></g></svg>感谢</button><button class="Button ContentItem-action ContentItem-rightButton Button--plain" data-zop-retract-question="true" type="button"><span class="RichContent-collapsedText">收起</span><svg viewBox="0 0 10 6" class="Icon ContentItem-arrowIcon is-active Icon--arrow" style="height:16px;width:10px;" width="10" height="16" aria-hidden="true"><title></title><g><path d="M8.716.217L5.002 4 1.285.218C.99-.072.514-.072.22.218c-.294.29-.294.76 0 1.052l4.25 4.512c.292.29.77.29 1.063 0L9.78 1.27c.293-.29.293-.76 0-1.052-.295-.29-.77-.29-1.063 0z"/></g></svg></button></div></div></div></div></div></div></div><div class="Card"><button class="Button QuestionMainAction" type="button">查看更多回答</button></div></div><div class="CollapsedAnswers-bar"><button class="Button Button--plain" type="button">4 个回答被折叠</button>（<a class="Button Button--plain" target="_blank" type="button" href="/question/20120168">为什么？</a>）</div></div></div></div></div></main></div></div><div id="data" style="display:none;" data-state="{&quot;loading&quot;:{&quot;global&quot;:{&quot;count&quot;:0},&quot;local&quot;:{&quot;token/&quot;:false,&quot;env/getExperiments/&quot;:false,&quot;config/getAppConfig/&quot;:false,&quot;question/get/&quot;:false,&quot;question/getAnswers/42162310&quot;:false}},&quot;entities&quot;:{&quot;users&quot;:{},&quot;questions&quot;:{&quot;42162310&quot;:{&quot;status&quot;:{&quot;isLocked&quot;:false,&quot;isClose&quot;:false,&quot;isEvaluate&quot;:false,&quot;isSuggest&quot;:false},&quot;visitCount&quot;:267703,&quot;author&quot;:{&quot;isFollowed&quot;:false,&quot;avatarUrlTemplate&quot;:&quot;https://pic4.zhimg.com/22633ddcf_{size}.jpg&quot;,&quot;name&quot;:&quot;黄席盛&quot;,&quot;headline&quot;:&quot;一生只做正确的事&quot;,&quot;type&quot;:&quot;people&quot;,&quot;userType&quot;:&quot;people&quot;,&quot;urlToken&quot;:&quot;huangxisheng&quot;,&quot;isAdvertiser&quot;:false,&quot;avatarUrl&quot;:&quot;https://pic4.zhimg.com/22633ddcf_is.jpg&quot;,&quot;isFollowing&quot;:false,&quot;isOrg&quot;:false,&quot;gender&quot;:1,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/people/609f0553bf6038c0126608bb2ff0f766&quot;,&quot;badge&quot;:[],&quot;id&quot;:&quot;609f0553bf6038c0126608bb2ff0f766&quot;},&quot;relationship&quot;:{&quot;concernedFollowers&quot;:[],&quot;isAnonymous&quot;:false,&quot;canLock&quot;:false,&quot;isFollowing&quot;:false,&quot;isAuthor&quot;:false,&quot;canCollapseAnswers&quot;:false,&quot;canStickAnswers&quot;:false},&quot;isMuted&quot;:false,&quot;topics&quot;:[{&quot;introduction&quot;:&quot;&quot;,&quot;avatarUrl&quot;:&quot;https://pic1.zhimg.com/v2-688981de9d4e075d339c0a58925453f0_is.jpg&quot;,&quot;name&quot;:&quot;视频直播&quot;,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/topics/19581451&quot;,&quot;type&quot;:&quot;topic&quot;,&quot;excerpt&quot;:&quot;&quot;,&quot;id&quot;:&quot;19581451&quot;},{&quot;introduction&quot;:&quot;&quot;,&quot;avatarUrl&quot;:&quot;https://pic1.zhimg.com/e82bab09c_is.jpg&quot;,&quot;name&quot;:&quot;视频点播&quot;,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/topics/19617373&quot;,&quot;type&quot;:&quot;topic&quot;,&quot;excerpt&quot;:&quot;&quot;,&quot;id&quot;:&quot;19617373&quot;},{&quot;introduction&quot;:&quot;网络主播是属于通过网络视频直播间、聊天室，通过展示自己的才艺，获得平台用户的欢迎，以及收取游客礼物的形式获得收入的一种网络新兴职业。&quot;,&quot;avatarUrl&quot;:&quot;https://pic2.zhimg.com/6574c9e94636a0391e70f9ad62b0590d_is.jpg&quot;,&quot;name&quot;:&quot;网络主播&quot;,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/topics/19649229&quot;,&quot;type&quot;:&quot;topic&quot;,&quot;excerpt&quot;:&quot;网络主播是属于通过网络视频直播间、聊天室，通过展示自己的才艺，获得平台用户的欢迎，以及收取游客礼物的形式获得收入的一种网络新兴职业。&quot;,&quot;id&quot;:&quot;19649229&quot;},{&quot;introduction&quot;:&quot;&quot;,&quot;avatarUrl&quot;:&quot;https://pic1.zhimg.com/e82bab09c_is.jpg&quot;,&quot;name&quot;:&quot;带宽管理&quot;,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/topics/19792905&quot;,&quot;type&quot;:&quot;topic&quot;,&quot;excerpt&quot;:&quot;&quot;,&quot;id&quot;:&quot;19792905&quot;}],&quot;excerpt&quot;:&quot;朋友打算打造一个全新模式的视频直播平台，主要功能有些类似现在很多的美女直播平台。假设前期同时在线观看人数为2W人，清晰度不低于720P，拥有美颜、混音等附加功能，还有最重要的不能卡顿。如果以上假设成立，需要做哪些准备工作，技术门槛有多高，资金支出要多少？&quot;,&quot;adminClosedComment&quot;:false,&quot;except&quot;:&quot;朋友打算打造一个全新模式的视频直播平台，主要功能有些类似现在很多的美女直播平台。假设前期同时在线观看人数为2W人，清晰度不低于720P，拥有美颜、混音等附加功能，还有最重要的不能卡顿。如果以上假设成立，需要做哪些准备工作，技术门槛有多高，资金支出要多少？&quot;,&quot;isEditable&quot;:false,&quot;answerCount&quot;:113,&quot;editableDetail&quot;:&quot;朋友打算打造一个全新模式的视频直播平台，主要功能有些类似现在很多的美女直播平台。假设前期同时在线观看人数为2W人，清晰度不低于720P，拥有美颜、混音等附加功能，还有最重要的不能卡顿。如果以上假设成立，需要做哪些准备工作，技术门槛有多高，资金支出要多少？&quot;,&quot;id&quot;:42162310,&quot;collapsedAnswerCount&quot;:4,&quot;title&quot;:&quot;如何搭建一个完整的视频直播系统？&quot;,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/questions/42162310&quot;,&quot;commentPermission&quot;:&quot;all&quot;,&quot;created&quot;:1459845051,&quot;detail&quot;:&quot;朋友打算打造一个全新模式的视频直播平台，主要功能有些类似现在很多的美女直播平台。假设前期同时在线观看人数为2W人，清晰度不低于720P，拥有美颜、混音等附加功能，还有最重要的不能卡顿。如果以上假设成立，需要做哪些准备工作，技术门槛有多高，资金支出要多少？&quot;,&quot;updatedTime&quot;:1459845051,&quot;isReportable&quot;:true,&quot;hasPublishingDraft&quot;:false,&quot;commentCount&quot;:16,&quot;allowDelete&quot;:false,&quot;questionType&quot;:&quot;normal&quot;,&quot;followerCount&quot;:7629,&quot;canComment&quot;:{&quot;status&quot;:true,&quot;reason&quot;:&quot;&quot;},&quot;type&quot;:&quot;question&quot;,&quot;suggestEdit&quot;:{&quot;status&quot;:false,&quot;reason&quot;:&quot;&quot;},&quot;isNormal&quot;:true}},&quot;answers&quot;:{&quot;93858266&quot;:{&quot;stickyInfo&quot;:&quot;&quot;,&quot;relationship&quot;:{&quot;upvotedFollowees&quot;:[],&quot;isAuthor&quot;:false,&quot;isNothelp&quot;:false,&quot;isAuthorized&quot;:false,&quot;voting&quot;:0,&quot;isThanked&quot;:false},&quot;editableContent&quot;:&quot;&quot;,&quot;markInfos&quot;:[{&quot;markType&quot;:&quot;editor_recommendation&quot;}],&quot;excerpt&quot;:&quot;视频直播，可以分为 采集，前处理，编码，传输，解码，渲染 这几个环节，下面分别说下： 采集，iOS是比较简单的，Android则要做些机型适配工作，PC最麻烦各种奇葩摄像头驱动，出了问题特别不好处理，建议放弃PC只支持手机主播，目前几个新进的直播平台都是…&quot;,&quot;annotationAction&quot;:[],&quot;adminClosedComment&quot;:false,&quot;collapsedBy&quot;:&quot;nobody&quot;,&quot;canComment&quot;:{&quot;status&quot;:true,&quot;reason&quot;:&quot;&quot;},&quot;createdTime&quot;:1459871707,&quot;updatedTime&quot;:1459912254,&quot;id&quot;:93858266,&quot;voteupCount&quot;:2231,&quot;collapseReason&quot;:&quot;&quot;,&quot;isCollapsed&quot;:false,&quot;author&quot;:{&quot;isFollowed&quot;:false,&quot;avatarUrlTemplate&quot;:&quot;https://pic2.zhimg.com/v2-e579c26575f3f2b46450f0805a41ea91_{size}.jpg&quot;,&quot;userType&quot;:&quot;people&quot;,&quot;badge&quot;:[{&quot;topics&quot;:[{&quot;introduction&quot;:&quot;程序员可以指在程序设计与互联网某个专业领域中的专业人士或是从事软件撰写，程序开发、维护的专业人员。&quot;,&quot;avatarUrl&quot;:&quot;https://pic3.zhimg.com/acda162ad89c9b8995b51028d5233d1a_is.jpg&quot;,&quot;name&quot;:&quot;程序员&quot;,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/topics/19552330&quot;,&quot;type&quot;:&quot;topic&quot;,&quot;excerpt&quot;:&quot;程序员可以指在程序设计与互联网某个专业领域中的专业人士或是从事软件撰写，程序开发、维护的专业人员。&quot;,&quot;id&quot;:&quot;19552330&quot;},{&quot;introduction&quot;:&quot;人们为了让计算机解决各种棘手的问题，使用编程语言&lt;b&gt;编写程序代码&lt;/b&gt;并通过计算机运算得到最终结果的过程。&quot;,&quot;avatarUrl&quot;:&quot;https://pic3.zhimg.com/f030b9281d94edbdbe57009a94ffab12_is.jpg&quot;,&quot;name&quot;:&quot;编程&quot;,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/topics/19554298&quot;,&quot;type&quot;:&quot;topic&quot;,&quot;excerpt&quot;:&quot;人们为了让计算机解决各种棘手的问题，使用编程语言编写程序代码并通过计算机运算得到最终结果的过程。&quot;,&quot;id&quot;:&quot;19554298&quot;},{&quot;introduction&quot;:&quot;C++是一种使用非常广泛的计算机程序设计语言。它是一种静态数据类型（static data type）检查的，支持多范式（multi-paradigm）的通用程序设计语言。C++支持面向过程编程（Procedures Programming）、数据抽象化（Data Abstraction）、面向对象程序设计（Object-Oriented Programming）、泛型程序设计（Generic-Type Programming）、基于原则设计（Policy-Based Class Design）等多种程序设计风格。 (from Wikipedia)&quot;,&quot;avatarUrl&quot;:&quot;https://pic1.zhimg.com/9db7191dc_is.jpg&quot;,&quot;name&quot;:&quot;C++&quot;,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/topics/19584970&quot;,&quot;type&quot;:&quot;topic&quot;,&quot;excerpt&quot;:&quot;C++是一种使用非常广泛的计算机程序设计语言。它是一种静态数据类型（static data type）检查的，支持多范式（multi-paradigm）的通用程序设计语言。C++支持面向过程编程（Procedures Programming）、数据抽象化（Data Abstraction）、面向对象程序设计（Object-Oriented Programming）、泛型程序设计（Generic-Type Programming）、基于原则设计（Policy-Based Class Design）等多种程序设计风格。 (from Wikipedia)&quot;,&quot;id&quot;:&quot;19584970&quot;}],&quot;type&quot;:&quot;best_answerer&quot;,&quot;description&quot;:&quot;优秀回答者&quot;}],&quot;isFollowing&quot;:false,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/people/71637fe077b9a2d7be320e2800ccd818&quot;,&quot;urlToken&quot;:&quot;yao-dong-27&quot;,&quot;id&quot;:&quot;71637fe077b9a2d7be320e2800ccd818&quot;,&quot;name&quot;:&quot;姚冬&quot;,&quot;headline&quot;:&quot;Next Big Thing&quot;,&quot;gender&quot;:1,&quot;isAdvertiser&quot;:false,&quot;avatarUrl&quot;:&quot;https://pic2.zhimg.com/v2-e579c26575f3f2b46450f0805a41ea91_is.jpg&quot;,&quot;isOrg&quot;:false,&quot;followerCount&quot;:81435,&quot;type&quot;:&quot;people&quot;},&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/answers/93858266&quot;,&quot;commentPermission&quot;:&quot;all&quot;,&quot;isSticky&quot;:false,&quot;question&quot;:{&quot;author&quot;:{&quot;isFollowed&quot;:false,&quot;avatarUrlTemplate&quot;:&quot;https://pic4.zhimg.com/22633ddcf_{size}.jpg&quot;,&quot;badge&quot;:[],&quot;name&quot;:&quot;黄席盛&quot;,&quot;headline&quot;:&quot;一生只做正确的事&quot;,&quot;urlToken&quot;:&quot;huangxisheng&quot;,&quot;userType&quot;:&quot;people&quot;,&quot;isAdvertiser&quot;:false,&quot;avatarUrl&quot;:&quot;https://pic4.zhimg.com/22633ddcf_is.jpg&quot;,&quot;isFollowing&quot;:false,&quot;isOrg&quot;:false,&quot;gender&quot;:1,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/people/609f0553bf6038c0126608bb2ff0f766&quot;,&quot;type&quot;:&quot;people&quot;,&quot;id&quot;:&quot;609f0553bf6038c0126608bb2ff0f766&quot;},&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/questions/42162310&quot;,&quot;title&quot;:&quot;如何搭建一个完整的视频直播系统？&quot;,&quot;created&quot;:1459845051,&quot;questionType&quot;:&quot;normal&quot;,&quot;updatedTime&quot;:1459845051,&quot;type&quot;:&quot;question&quot;,&quot;id&quot;:42162310},&quot;suggestEdit&quot;:{&quot;status&quot;:false,&quot;reason&quot;:&quot;&quot;,&quot;title&quot;:&quot;&quot;,&quot;url&quot;:&quot;&quot;,&quot;unnormalDetails&quot;:{},&quot;tip&quot;:&quot;&quot;},&quot;content&quot;:&quot;视频直播，可以分为 采集，前处理，编码，传输，解码，渲染 这几个环节，下面分别说下：&lt;br&gt;&lt;br&gt;采集，iOS是比较简单的，Android则要做些机型适配工作，PC最麻烦各种奇葩摄像头驱动，出了问题特别不好处理，建议放弃PC只支持手机主播，目前几个新进的直播平台都是这样的。&lt;br&gt;&lt;br&gt;前处理，现在直播美颜已经是标配了，80%的主播没有美颜根本没法看。美颜算法需要用到GPU编程，需要懂图像处理算法的人，没有好的开源实现，要自己参考论文去研究。难点不在于美颜效果，而在于GPU占用和美颜效果之间找平衡。GPU虽然性能好，但是也是有功耗的，GPU占用太高会导致手机发烫，而手机发烫会导致摄像头采集掉帧，iPhone6尤其明显，因为iPhone6的CPU和前置摄像头很近。&lt;br&gt;&lt;br&gt;编码，肯定要采用硬编码，软编码720p完全没希望，勉强能编码也会导致CPU过热烫到摄像头。硬编码兼容性又是一个大坑，android上要有人去填。编码要在分辨率，帧率，码率，GOP等参数设计上找到最佳平衡点。&lt;br&gt;&lt;br&gt;传输，自己做不现实，交给CDN服务商吧，也就是贵了点，相信有志于做直播平台改变世界的你不差钱。假设2W PCU大约每月带宽费用100万左右，因为清晰流畅的720p要1.5mbps左右。CDN只提供了带宽和服务器间传输，发送和接收端的网络连接抖动缓冲还是要自己写的。不想要卡顿，必然要加大缓冲，会导致延迟高，延迟高影响互动性，要做权衡。&lt;br&gt;&lt;br&gt;解码，也肯定要硬解码，目前手机普遍支持硬解了，只是android上还是有兼容性大坑要填。&lt;br&gt;&lt;br&gt;渲染，这个难点不在于绘制，而在于音画同步，目前几个直播做得都不好。&lt;br&gt;&lt;br&gt;此外音频还有几个坑要填，比如降噪，音频编码器的选择，各种蓝牙耳机，各种播放模式的适配等，如果你想做主播和观众连线聊天，还有个回声消除问题。&lt;br&gt;&lt;br&gt;以上是媒体模块，还有信令控制，登录、鉴权、权限管理、状态管理等等，各种应用服务，消息推送，聊天，礼物系统，支付系统，运营支持系统，统计系统等。&lt;br&gt;&lt;br&gt;后台还有数据库，缓存，分布式文件存储，消息队列，运维系统等。&lt;br&gt;&lt;br&gt;这些显然不是一个程序员能解决的，如果真的有这样的高手，请联系我，无论你现在薪水多少，我都出两倍。&lt;br&gt;&lt;br&gt;第一期至少要融资2000万RMB，组建至少10人的技术团队，10人的产品运营团队，争取3个月产品上线，半年达到5W在线（2w 根本不够）然后融资1个亿，或许还有希望一搏。&lt;br&gt;&lt;br&gt;也许有人对带宽问题存疑，请参考欢聚时代15年四季度财报，带宽成本为人民币1.611亿元，折合每月5000+万，当然不能用这个数去推算在线人数，因为YY采购量很大所以带宽平均成本低，而且YY不只是高清直播，还有很大比例的500kbps左右码率的直播，还有相当一部分带宽是靠P2P解决的。总之带宽非常贵。&lt;br&gt;&lt;br&gt;祝你朋友好运。&quot;,&quot;commentCount&quot;:142,&quot;extras&quot;:&quot;&quot;,&quot;reshipmentSettings&quot;:&quot;allowed&quot;,&quot;thanksCount&quot;:480,&quot;rewardInfo&quot;:{&quot;rewardMemberCount&quot;:0,&quot;tagline&quot;:&quot;&quot;,&quot;rewardTotalMoney&quot;:0,&quot;canOpenReward&quot;:false,&quot;isRewardable&quot;:false},&quot;isCopyable&quot;:true,&quot;type&quot;:&quot;answer&quot;,&quot;thumbnail&quot;:&quot;&quot;,&quot;isNormal&quot;:true},&quot;93871917&quot;:{&quot;stickyInfo&quot;:&quot;&quot;,&quot;relationship&quot;:{&quot;upvotedFollowees&quot;:[],&quot;isAuthor&quot;:false,&quot;isNothelp&quot;:false,&quot;isAuthorized&quot;:false,&quot;voting&quot;:0,&quot;isThanked&quot;:false},&quot;editableContent&quot;:&quot;&quot;,&quot;markInfos&quot;:[],&quot;excerpt&quot;:&quot;谢邀。刚刚接手 &lt;a href=\&quot;https://link.zhihu.com/?target=http%3A//www.quanmin.tv/\&quot; class=\&quot; wrap external\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;&gt;全民TV&lt;i class=\&quot;icon-external\&quot;&gt;&lt;/i&gt;&lt;/a&gt; 的研发团队不久，短期内还在疯狂填坑，在我看来，视频直播项目的研发算是涉及绝大多数主流互联网技术，整体做下来修为可以提升不少，大概把眼前的问题想了一下： PC、Android、iOS三大平台（一般互联网创业项目标配）每个平台要做2种…&quot;,&quot;annotationAction&quot;:[],&quot;adminClosedComment&quot;:false,&quot;collapsedBy&quot;:&quot;nobody&quot;,&quot;canComment&quot;:{&quot;status&quot;:true,&quot;reason&quot;:&quot;&quot;},&quot;createdTime&quot;:1459879926,&quot;updatedTime&quot;:1468629872,&quot;id&quot;:93871917,&quot;voteupCount&quot;:624,&quot;collapseReason&quot;:&quot;&quot;,&quot;isCollapsed&quot;:false,&quot;author&quot;:{&quot;isFollowed&quot;:false,&quot;avatarUrlTemplate&quot;:&quot;https://pic1.zhimg.com/ecfeb2b0c_{size}.jpg&quot;,&quot;userType&quot;:&quot;people&quot;,&quot;badge&quot;:[{&quot;topics&quot;:[{&quot;introduction&quot;:&quot;web 前端开发&quot;,&quot;avatarUrl&quot;:&quot;https://pic1.zhimg.com/v2-8e66233f5558e741bad3a8c50b9566c8_is.jpg&quot;,&quot;name&quot;:&quot;前端开发&quot;,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/topics/19550901&quot;,&quot;type&quot;:&quot;topic&quot;,&quot;excerpt&quot;:&quot;web 前端开发&quot;,&quot;id&quot;:&quot;19550901&quot;},{&quot;introduction&quot;:&quot;JavaScript 是弱类型的动态脚本语言，支持多种编程范式，包括面向对象和函数式编程。&quot;,&quot;avatarUrl&quot;:&quot;https://pic1.zhimg.com/8993062b6b00237084be65f96b8fd720_is.jpg&quot;,&quot;name&quot;:&quot;JavaScript&quot;,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/topics/19552521&quot;,&quot;type&quot;:&quot;topic&quot;,&quot;excerpt&quot;:&quot;JavaScript 是弱类型的动态脚本语言，支持多种编程范式，包括面向对象和函数式编程。&quot;,&quot;id&quot;:&quot;19552521&quot;}],&quot;type&quot;:&quot;best_answerer&quot;,&quot;description&quot;:&quot;优秀回答者&quot;}],&quot;isFollowing&quot;:false,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/people/3212f9044005e9306aab1b61e74e7ae6&quot;,&quot;urlToken&quot;:&quot;fouber&quot;,&quot;id&quot;:&quot;3212f9044005e9306aab1b61e74e7ae6&quot;,&quot;name&quot;:&quot;张云龙&quot;,&quot;headline&quot;:&quot;全民直播CTO&quot;,&quot;gender&quot;:1,&quot;isAdvertiser&quot;:false,&quot;avatarUrl&quot;:&quot;https://pic1.zhimg.com/ecfeb2b0c_is.jpg&quot;,&quot;isOrg&quot;:false,&quot;followerCount&quot;:22212,&quot;type&quot;:&quot;people&quot;},&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/answers/93871917&quot;,&quot;commentPermission&quot;:&quot;all&quot;,&quot;isSticky&quot;:false,&quot;question&quot;:{&quot;author&quot;:{&quot;isFollowed&quot;:false,&quot;avatarUrlTemplate&quot;:&quot;https://pic4.zhimg.com/22633ddcf_{size}.jpg&quot;,&quot;badge&quot;:[],&quot;name&quot;:&quot;黄席盛&quot;,&quot;headline&quot;:&quot;一生只做正确的事&quot;,&quot;urlToken&quot;:&quot;huangxisheng&quot;,&quot;userType&quot;:&quot;people&quot;,&quot;isAdvertiser&quot;:false,&quot;avatarUrl&quot;:&quot;https://pic4.zhimg.com/22633ddcf_is.jpg&quot;,&quot;isFollowing&quot;:false,&quot;isOrg&quot;:false,&quot;gender&quot;:1,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/people/609f0553bf6038c0126608bb2ff0f766&quot;,&quot;type&quot;:&quot;people&quot;,&quot;id&quot;:&quot;609f0553bf6038c0126608bb2ff0f766&quot;},&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/questions/42162310&quot;,&quot;title&quot;:&quot;如何搭建一个完整的视频直播系统？&quot;,&quot;created&quot;:1459845051,&quot;questionType&quot;:&quot;normal&quot;,&quot;updatedTime&quot;:1459845051,&quot;type&quot;:&quot;question&quot;,&quot;id&quot;:42162310},&quot;suggestEdit&quot;:{&quot;status&quot;:false,&quot;reason&quot;:&quot;&quot;,&quot;title&quot;:&quot;&quot;,&quot;url&quot;:&quot;&quot;,&quot;unnormalDetails&quot;:{},&quot;tip&quot;:&quot;&quot;},&quot;content&quot;:&quot;谢邀。刚刚接手 &lt;a href=\&quot;https://link.zhihu.com/?target=http%3A//www.quanmin.tv/\&quot; class=\&quot; wrap external\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;&gt;全民TV&lt;i class=\&quot;icon-external\&quot;&gt;&lt;/i&gt;&lt;/a&gt; 的研发团队不久，短期内还在疯狂填坑，在我看来，视频直播项目的研发算是涉及绝大多数主流互联网技术，整体做下来修为可以提升不少，大概把眼前的问题想了一下：&lt;br&gt;&lt;ul&gt;&lt;li&gt;PC、Android、iOS三大平台（一般互联网创业项目标配）&lt;/li&gt;&lt;li&gt;每个平台要做2种端：面向客户的直播端，和面向主播的推流端（标配x2）&lt;br&gt;&lt;/li&gt;&lt;li&gt;视频编码涉及非常多的技术参数和细节（领域特殊技术）&lt;/li&gt;&lt;li&gt;完整的礼物系统、支付系统、运营系统、任务系统（不亚于一般页游项目）&lt;/li&gt;&lt;li&gt;即时聊天IM服务（弹幕，既要保证实时性，又要抗住高并发）&lt;/li&gt;&lt;li&gt;视频推流拉流链路依赖第三方CDN（超越一般创业项目的运维成本）&lt;/li&gt;&lt;li&gt;因为涉及钱的问题，经常与各种黑暗势力斗争（色情、广告、刷小号、刷充值、告侵权、DDoS等等）&lt;/li&gt;&lt;/ul&gt;&lt;a data-hash=\&quot;71637fe077b9a2d7be320e2800ccd818\&quot; href=\&quot;https://www.zhihu.com/people/71637fe077b9a2d7be320e2800ccd818\&quot; class=\&quot;member_mention\&quot; data-editable=\&quot;true\&quot; data-title=\&quot;@姚冬\&quot; data-tip=\&quot;p$b$71637fe077b9a2d7be320e2800ccd818\&quot; data-hovercard=\&quot;p$b$71637fe077b9a2d7be320e2800ccd818\&quot;&gt;@姚冬&lt;/a&gt;大神 回答了很多视频直播相关的技术难点，这算是视频直播中最核心的技术之一了，但对于创业团队来说，还有更多技术攻坚之外的技术压力：&lt;br&gt;&lt;ul&gt;&lt;li&gt;即使聊天IM技术难度也很大啊，尼玛一个大主播的直播间有十几万人同时在线，一个人发消息要十几万人都收到啊，大主播还经常带节奏，十几万人一起发消息要十几万人一起收啊，想象这个瞬间的高峰是个什么鬼！&lt;/li&gt;&lt;li&gt;视频直播的链路很长，CDN经常坑爹啊，主播推流客户端各种乱配，运营商各种劫持，出了问题都不知道甩锅给谁啊！&lt;/li&gt;&lt;li&gt;支付系统一定要仔细搞啊，每个环节都要仔细想清楚各种异常情况啊，所有消费都要有流水记录，警惕苹果黑卡啊&lt;/li&gt;&lt;li&gt;研发团队不好招人啊，我每周筛选6、70份简历，安排面试1、20人，也才能敲定3、4个offer，以这样的强度估计还要再坚持几个月啊&lt;/li&gt;&lt;li&gt;各种合作方的接入，各种赛事活动的接入，市场、运营、产品、客服各方都给你提需求啊，一个人要掰成好几个人用&lt;/li&gt;&lt;li&gt;即便如此，作为研发，看到不顺心的代码还是想重构啊，要在高速公路上冒着烟极速飞奔的汽车上，一边开车一边换轮胎啊！&lt;/li&gt;&lt;li&gt;团队快速扩张，彼此要磨合，管理能力还要能跟上啊，新人大量加入，还要安排好工作啊。&lt;/li&gt;&lt;/ul&gt;总之过去的一个月我是感觉自己无论在技术能力还是管理能力上的进步好像都超过了此前5年在大公司积累的总和，做视频直播项目真的很虐心，也真的非常磨练人，现在整个视频直播领域狼烟四起，颇有当年百团大战的意味，作为研发，我想要是能与现在的团队一起奋斗成长，并在这个领域争得一块立足之地，也算是一项非常了不起的成就了。&lt;br&gt;&lt;br&gt;如果你仅仅为了一个构想的新模式而尝试涉足我觉得现在这个时间点已经没有必要了，各方面资源的投入成本都会非常非常高，做个demo玩玩还行，深入做下去真是山高路远坑深。&lt;br&gt;&lt;br&gt;顺便打个广告，为我的团队招人，可以发简历到 zhangyunlong@qmtv.com&quot;,&quot;commentCount&quot;:124,&quot;extras&quot;:&quot;&quot;,&quot;reshipmentSettings&quot;:&quot;disallowed&quot;,&quot;thanksCount&quot;:102,&quot;rewardInfo&quot;:{&quot;rewardMemberCount&quot;:0,&quot;tagline&quot;:&quot;&quot;,&quot;rewardTotalMoney&quot;:0,&quot;canOpenReward&quot;:false,&quot;isRewardable&quot;:false},&quot;isCopyable&quot;:false,&quot;type&quot;:&quot;answer&quot;,&quot;thumbnail&quot;:&quot;&quot;,&quot;isNormal&quot;:true},&quot;105746193&quot;:{&quot;stickyInfo&quot;:&quot;&quot;,&quot;relationship&quot;:{&quot;upvotedFollowees&quot;:[],&quot;isAuthor&quot;:false,&quot;isNothelp&quot;:false,&quot;isAuthorized&quot;:false,&quot;voting&quot;:0,&quot;isThanked&quot;:false},&quot;editableContent&quot;:&quot;&quot;,&quot;markInfos&quot;:[],&quot;excerpt&quot;:&quot;技术点大家都回答的很详细了，我就我觉得视频直播系统中的一些难点再和大家分享下。 两年前我在做媒体云的时候，当时都是点播的业务。做到后面，我觉得点播业务其实并不像想象的那么难，你想你有一个稳定的存储，找一家靠谱的 CDN，然后找一个大概能用的播…&quot;,&quot;annotationAction&quot;:[],&quot;adminClosedComment&quot;:false,&quot;collapsedBy&quot;:&quot;nobody&quot;,&quot;canComment&quot;:{&quot;status&quot;:true,&quot;reason&quot;:&quot;&quot;},&quot;createdTime&quot;:1465798869,&quot;updatedTime&quot;:1465798869,&quot;id&quot;:105746193,&quot;voteupCount&quot;:831,&quot;collapseReason&quot;:&quot;&quot;,&quot;isCollapsed&quot;:false,&quot;author&quot;:{&quot;isFollowed&quot;:false,&quot;avatarUrlTemplate&quot;:&quot;https://pic4.zhimg.com/6965601da36c92ae82390605f2e86337_{size}.jpg&quot;,&quot;userType&quot;:&quot;people&quot;,&quot;badge&quot;:[],&quot;isFollowing&quot;:false,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/people/da4af975aac156382bfe6088840cb4e5&quot;,&quot;urlToken&quot;:&quot;zhu-zheng-35-16&quot;,&quot;id&quot;:&quot;da4af975aac156382bfe6088840cb4e5&quot;,&quot;name&quot;:&quot;金山18667号码农&quot;,&quot;headline&quot;:&quot;码农&quot;,&quot;gender&quot;:1,&quot;isAdvertiser&quot;:false,&quot;avatarUrl&quot;:&quot;https://pic4.zhimg.com/6965601da36c92ae82390605f2e86337_is.jpg&quot;,&quot;isOrg&quot;:false,&quot;followerCount&quot;:531,&quot;type&quot;:&quot;people&quot;},&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/answers/105746193&quot;,&quot;commentPermission&quot;:&quot;all&quot;,&quot;isSticky&quot;:false,&quot;question&quot;:{&quot;author&quot;:{&quot;isFollowed&quot;:false,&quot;avatarUrlTemplate&quot;:&quot;https://pic4.zhimg.com/22633ddcf_{size}.jpg&quot;,&quot;badge&quot;:[],&quot;name&quot;:&quot;黄席盛&quot;,&quot;headline&quot;:&quot;一生只做正确的事&quot;,&quot;urlToken&quot;:&quot;huangxisheng&quot;,&quot;userType&quot;:&quot;people&quot;,&quot;isAdvertiser&quot;:false,&quot;avatarUrl&quot;:&quot;https://pic4.zhimg.com/22633ddcf_is.jpg&quot;,&quot;isFollowing&quot;:false,&quot;isOrg&quot;:false,&quot;gender&quot;:1,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/people/609f0553bf6038c0126608bb2ff0f766&quot;,&quot;type&quot;:&quot;people&quot;,&quot;id&quot;:&quot;609f0553bf6038c0126608bb2ff0f766&quot;},&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/questions/42162310&quot;,&quot;title&quot;:&quot;如何搭建一个完整的视频直播系统？&quot;,&quot;created&quot;:1459845051,&quot;questionType&quot;:&quot;normal&quot;,&quot;updatedTime&quot;:1459845051,&quot;type&quot;:&quot;question&quot;,&quot;id&quot;:42162310},&quot;suggestEdit&quot;:{&quot;status&quot;:false,&quot;reason&quot;:&quot;&quot;,&quot;title&quot;:&quot;&quot;,&quot;url&quot;:&quot;&quot;,&quot;unnormalDetails&quot;:{},&quot;tip&quot;:&quot;&quot;},&quot;content&quot;:&quot;技术点大家都回答的很详细了，我就我觉得视频直播系统中的一些难点再和大家分享下。&lt;br&gt;&lt;br&gt;&lt;p&gt;两年前我在做媒体云的时候，当时都是点播的业务。做到后面，我觉得点播业务其实并不像想象的那么难，你想你有一个稳定的存储，找一家靠谱的 CDN，然后找一个大概能用的播放器就做出来了，这有什么难的呢？你可以找云服务公司，也可以找外包，或者你自己招一个人都能做。但是现在发现到了移动，尤其是 3月份移动直播火起来之后，这个门槛突然变高了。因为内容产生方变成了移动端。从几个点来分析下为什么：&lt;/p&gt;&lt;br&gt;&lt;p&gt;&lt;b&gt;1 &lt;/b&gt;&lt;b&gt;、首先内容产生方就是推流端，&lt;/b&gt;现在主流的 IOS、安卓，IOS比较简单，就是那个几个机型，基本大家适配都很好。但是安卓的碎片化是非常严重的，大量的精力都需要做对安卓的适配，而且软编耗电量普遍非常高，手机用了一会就会发烫，都担心会不会爆炸。用户体验就是在不同的网络情况下，上传的视频有可能会卡，有可能不连贯，报各种各样的错误，这个是作为一个开发者他自己不可能去适配的。说白了从用户那边提的需求就是推流端不能卡，画质要好，不能太烫，这是我们接触到的客户真正提的问题，是我们从有点偏技术的角度抽取出来的，它背后对应的是哪些事情。&lt;/p&gt;&lt;p&gt;&lt;b&gt;2 &lt;/b&gt;&lt;b&gt;、然后是分发网络。&lt;/b&gt;分发网络其实躲在一个很后面的地方，用户其实看不见的。真正对分发网络提需求用户也提不出来，所以基本这部分需求都会提给播放端，提的需求也是不能卡，不能花屏，首屏一定要快，一点就要看到，还不能把延时弄的太大。其实这些很多都是和源站分发网络有关系的，只是用户看不到这个需求会跟后面的播放器接在一起。&lt;/p&gt;&lt;p&gt;像首屏时间，就是用户点开就要看，以前那些开源架构就是 rtmp server，它是做不到一点开就能看的，现在一些开源的国内资源写得也比较好了，可以看到。我们是自己开发的，所以也花了一些工作，能保存之前的关键帧的信息，用户一点开就能看，这个就是很细节的东西了。如果这个做不好的话，会黑屏、绿屏，或者是半天看不着图像。&lt;/p&gt;&lt;p&gt;&lt;b&gt;3、&lt;/b&gt;&lt;b&gt;在播放器这边也是我们在接业务的时候&lt;/b&gt;，遇到用户投诉最多的，因为所有的问题都是在观看的时候体现的，所有的雷都得是播放器的同学去扛。这个需求也是不能卡，不能延迟太高。如果延迟高了，要追回来，追的时候声音不能变，最好是追的策略也能自己控制，这是用户真正提出来的需求。&lt;/p&gt;&lt;br&gt;&lt;p&gt;要满足这些需求，我们需要做好多分辨率的适配，保证好流畅性，保证好我们追赶的策略不会出现任何异常。所以这三个端很多是相互耦合的，像推流和分发在一起，要保障好用户的流畅性和画质，分发和播放器在一起要保证好低延时和播放的流畅。所有的这些需求里共同的一点就是不能卡顿。&lt;/p&gt;&lt;br&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic3.zhimg.com/305d29e8d0c2d3317d34286f2c75dcba_b.jpg\&quot; data-rawwidth=\&quot;803\&quot; data-rawheight=\&quot;322\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;803\&quot; data-original=\&quot;https://pic3.zhimg.com/305d29e8d0c2d3317d34286f2c75dcba_r.jpg\&quot;&gt;&lt;/noscript&gt;&lt;img src=\&quot;//zhstatic.zhihu.com/assets/zhihu/ztext/whitedot.jpg\&quot; data-rawwidth=\&quot;803\&quot; data-rawheight=\&quot;322\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;803\&quot; data-original=\&quot;https://pic3.zhimg.com/305d29e8d0c2d3317d34286f2c75dcba_r.jpg\&quot; data-actualsrc=\&quot;https://pic3.zhimg.com/305d29e8d0c2d3317d34286f2c75dcba_b.jpg\&quot;&gt;&lt;p&gt;这个是我们的系统架构图。最下层是依托金山的云服务，因为我们已经有了很好的平台，提供了我们计算资源，提供了存储，提供了很多自建的节点，当然还不够多，我们还是个融合 CDN，然后提供了数据分析的能力。我们依托它做了橙色的这一层，就是我们自己的核心，流媒体直播，然后围绕这个核心我们在做的回看点播、在线转码、鉴权、内容审核。&lt;/p&gt;&lt;br&gt;&lt;p&gt;&lt;b&gt;1.回看点播：&lt;/b&gt;因为这不是一个短视频录播的项目，而是一个直播，直播就决定它的并发不会很高，内容不会很多，热点比较少。如果你不回看的话，用户很难维持它的日活，很难维护用户黏度，所以用户一定会要求做回看的。&lt;/p&gt;&lt;p&gt;&lt;b&gt;2.在线转码：&lt;/b&gt;推流端其实做了很多把更好的画质想尽办法传上来的工作，投了很多人力来做。传上来之后，观看也在移动端，它不一定看得了。如果他看不了怎么办？我们就需要在线转，在线转码其实承担的更多更重要的事情。&lt;/p&gt;&lt;p&gt;&lt;b&gt;3.鉴权：&lt;/b&gt;用户都不想被盗链，尤其是推流的时候，如果我不鉴权，谁都可以来推。所以这是必须要有的&lt;/p&gt;&lt;p&gt;&lt;b&gt;4.内容审核：&lt;/b&gt;现在我们没有办法帮他做到自动审核，技术还不够。现在做到的是截图，按用户指定的时间定期截图，这样的话，用户就可以请一些外包来看是不是有敏感内容，是不是要下线，这个对于现在这种三四秒延迟的直播来说非常重要。你做不到的话，没准政策因素你就做不下去了。&lt;/p&gt;&lt;p&gt;&lt;b&gt;5.数据分析：&lt;/b&gt;一部分是依托金山已有的，一部分是我们自己做的，因为我们延迟性，时效性要求更高。客户会经常大半夜突然提出一个主播看起来特别卡，问你为什么，要是像以前那种方式，一个小时生成报表，然后出体验图，告诉他为什么卡了，客户可没有这个耐心。我们现在基本能做到5秒间隔就出之前的各种问题定位，这个定位包括从源站收集的数据画的曲线。还有从端上，如果端上用户允许的话，推流和拉流端我们都会有上报数据，几个曲线一拟合，我们就知道问题出在哪里。&lt;/p&gt;&lt;br&gt;&lt;p&gt;利息相关：金山云架构师。&lt;/p&gt;&quot;,&quot;commentCount&quot;:4,&quot;extras&quot;:&quot;&quot;,&quot;reshipmentSettings&quot;:&quot;allowed&quot;,&quot;thanksCount&quot;:14,&quot;rewardInfo&quot;:{&quot;rewardMemberCount&quot;:0,&quot;tagline&quot;:&quot;&quot;,&quot;rewardTotalMoney&quot;:0,&quot;canOpenReward&quot;:false,&quot;isRewardable&quot;:false},&quot;isCopyable&quot;:true,&quot;type&quot;:&quot;answer&quot;,&quot;thumbnail&quot;:&quot;https://pic3.zhimg.com/305d29e8d0c2d3317d34286f2c75dcba_200x112.jpg&quot;,&quot;isNormal&quot;:true}},&quot;articles&quot;:{},&quot;columns&quot;:{},&quot;topics&quot;:{},&quot;roundtables&quot;:{},&quot;favlists&quot;:{},&quot;comments&quot;:{},&quot;notifications&quot;:{},&quot;ebooks&quot;:{},&quot;activities&quot;:{},&quot;feeds&quot;:{},&quot;pins&quot;:{},&quot;promotions&quot;:{}},&quot;currentUser&quot;:&quot;&quot;,&quot;token&quot;:{&quot;xsrf&quot;:&quot;cca114e4-aebf-413f-b928-0c3ef9110776&quot;,&quot;xUDID&quot;:&quot;&quot;},&quot;account&quot;:{&quot;locakTicketStatus&quot;:false,&quot;challenge&quot;:[],&quot;errorStatus&quot;:false,&quot;message&quot;:&quot;&quot;,&quot;isFetching&quot;:false},&quot;notification&quot;:{},&quot;people&quot;:{&quot;isFetching&quot;:false,&quot;activitiesByUser&quot;:{},&quot;answersByUser&quot;:{},&quot;answersSortByVotesByUser&quot;:{},&quot;answersMarkedByUser&quot;:{},&quot;votedAnswersByUser&quot;:{},&quot;thankedAnswersByUser&quot;:{},&quot;voteAnswersByUser&quot;:{},&quot;thankAnswersByUser&quot;:{},&quot;topicAnswersByUser&quot;:{},&quot;articlesByUser&quot;:{},&quot;articlesSortByVotesByUser&quot;:{},&quot;pinsByUser&quot;:{},&quot;questionsByUser&quot;:{},&quot;commercialQuestionsByUser&quot;:{},&quot;favlistsByUser&quot;:{},&quot;followingByUser&quot;:{},&quot;followersByUser&quot;:{},&quot;mutualsByUser&quot;:{},&quot;followingColumnsByUser&quot;:{},&quot;followingQuestionsByUser&quot;:{},&quot;followingFavlistsByUser&quot;:{},&quot;followingTopicsByUser&quot;:{},&quot;publicationsByUser&quot;:{},&quot;columnsByUser&quot;:{},&quot;allFavlistsByUser&quot;:{},&quot;brands&quot;:null},&quot;env&quot;:{&quot;experiment&quot;:{&quot;ge3&quot;:&quot;ge3_9&quot;,&quot;ge2&quot;:&quot;ge2_1&quot;,&quot;nwebStickySidebar&quot;:&quot;sticky&quot;,&quot;favAct&quot;:&quot;default&quot;,&quot;default&quot;:&quot;None&quot;,&quot;mobileQaPageProxyHeifetz&quot;:&quot;m_qa_page_nweb&quot;,&quot;newMore&quot;:&quot;new&quot;,&quot;iOSNewestVersion&quot;:&quot;4.0.0&quot;,&quot;qrcodeLogin&quot;:&quot;qrcode&quot;,&quot;homeUi2&quot;:&quot;default&quot;,&quot;wechatShareModal&quot;:&quot;wechat_share_modal_show&quot;,&quot;qaStickySidebar&quot;:&quot;sticky_sidebar&quot;,&quot;androidProfilePanel&quot;:&quot;panel_b&quot;,&quot;liveStore&quot;:&quot;ls_a2_b2_c1_f2&quot;,&quot;zcmLighting&quot;:&quot;zcm&quot;},&quot;userAgent&quot;:{&quot;Edge&quot;:false,&quot;Wechat&quot;:false,&quot;Weibo&quot;:false,&quot;QQ&quot;:false,&quot;Mobile&quot;:false,&quot;Android&quot;:false,&quot;iOS&quot;:false,&quot;isAppleDevice&quot;:false,&quot;Zhihu&quot;:false,&quot;isBot&quot;:false,&quot;isWebView&quot;:false},&quot;trafficSource&quot;:&quot;&quot;,&quot;edition&quot;:{&quot;baidu&quot;:true,&quot;yidianzixun&quot;:false}},&quot;config&quot;:{&quot;isWindow&quot;:1,&quot;canWrite&quot;:false,&quot;alertTimeSpan&quot;:3600,&quot;tip&quot;:&quot;应国家法规对于帐号实名的要求，进行下一步操作前，需要先完成手机绑定。&quot;},&quot;pushNotifications&quot;:{&quot;default&quot;:{&quot;isFetching&quot;:false,&quot;isDrained&quot;:false,&quot;ids&quot;:[]},&quot;follow&quot;:{&quot;isFetching&quot;:false,&quot;isDrained&quot;:false,&quot;ids&quot;:[]},&quot;vote-thank&quot;:{&quot;isFetching&quot;:false,&quot;isDrained&quot;:false,&quot;ids&quot;:[]},&quot;currentTab&quot;:&quot;default&quot;,&quot;notificationsCount&quot;:{&quot;default&quot;:0,&quot;follow&quot;:0,&quot;vote-thank&quot;:0}},&quot;messages&quot;:{&quot;data&quot;:{},&quot;currentTab&quot;:&quot;common&quot;,&quot;messageCount&quot;:0},&quot;register&quot;:{&quot;registerValidateSucceeded&quot;:null,&quot;registerValidateErrors&quot;:{},&quot;registerConfirmError&quot;:null,&quot;sendDigitsError&quot;:null,&quot;registerConfirmSucceeded&quot;:null},&quot;login&quot;:{&quot;loginConfirmError&quot;:null,&quot;sendDigitsError&quot;:null,&quot;loginConfirmSucceeded&quot;:null,&quot;qrcodeLoginToken&quot;:&quot;&quot;,&quot;qrcodeLoginScanStatus&quot;:0,&quot;qrcodeLoginError&quot;:null,&quot;qrcodeLoginReturnNewToken&quot;:false},&quot;active&quot;:{&quot;sendDigitsError&quot;:null,&quot;activeConfirmSucceeded&quot;:null,&quot;activeConfirmError&quot;:null},&quot;question&quot;:{&quot;followers&quot;:{},&quot;concernedFollowers&quot;:{},&quot;answers&quot;:{&quot;42162310&quot;:{&quot;isFetching&quot;:false,&quot;isDrained&quot;:false,&quot;ids&quot;:[93858266,105746193,93871917],&quot;newIds&quot;:[93858266,105746193,93871917],&quot;totals&quot;:113,&quot;isPrevDrained&quot;:true,&quot;previous&quot;:&quot;http://www.zhihu.com/api/v4/questions/42162310/answers?sort_by=default&amp;include=data%5B%2A%5D.is_normal%2Cadmin_closed_comment%2Creward_info%2Cis_collapsed%2Cannotation_action%2Cannotation_detail%2Ccollapse_reason%2Cis_sticky%2Ccollapsed_by%2Csuggest_edit%2Ccomment_count%2Ccan_comment%2Ccontent%2Ceditable_content%2Cvoteup_count%2Creshipment_settings%2Ccomment_permission%2Ccreated_time%2Cupdated_time%2Creview_info%2Cquestion%2Cexcerpt%2Crelationship.is_authorized%2Cis_author%2Cvoting%2Cis_thanked%2Cis_nothelp%2Cupvoted_followees%3Bdata%5B%2A%5D.mark_infos%5B%2A%5D.url%3Bdata%5B%2A%5D.author.follower_count%2Cbadge%5B%3F%28type%3Dbest_answerer%29%5D.topics&amp;limit=3&amp;offset=0&quot;,&quot;next&quot;:&quot;http://www.zhihu.com/api/v4/questions/42162310/answers?sort_by=default&amp;include=data%5B%2A%5D.is_normal%2Cadmin_closed_comment%2Creward_info%2Cis_collapsed%2Cannotation_action%2Cannotation_detail%2Ccollapse_reason%2Cis_sticky%2Ccollapsed_by%2Csuggest_edit%2Ccomment_count%2Ccan_comment%2Ccontent%2Ceditable_content%2Cvoteup_count%2Creshipment_settings%2Ccomment_permission%2Ccreated_time%2Cupdated_time%2Creview_info%2Cquestion%2Cexcerpt%2Crelationship.is_authorized%2Cis_author%2Cvoting%2Cis_thanked%2Cis_nothelp%2Cupvoted_followees%3Bdata%5B%2A%5D.mark_infos%5B%2A%5D.url%3Bdata%5B%2A%5D.author.follower_count%2Cbadge%5B%3F%28type%3Dbest_answerer%29%5D.topics&amp;limit=3&amp;offset=3&quot;}},&quot;hiddenAnswers&quot;:{},&quot;createdAnswers&quot;:{},&quot;collapsedAnswers&quot;:{},&quot;notificationAnswers&quot;:{},&quot;invitationCandidates&quot;:{},&quot;inviters&quot;:{},&quot;invitees&quot;:{},&quot;similarQuestions&quot;:{},&quot;relatedLives&quot;:{},&quot;recommendReadings&quot;:{},&quot;bio&quot;:{},&quot;brand&quot;:{},&quot;commonAnswerCount&quot;:0,&quot;hiddenAnswerCount&quot;:0},&quot;comments&quot;:{&quot;pagination&quot;:{},&quot;collapsed&quot;:{},&quot;reverse&quot;:{},&quot;reviewing&quot;:{},&quot;conversation&quot;:{},&quot;parent&quot;:{}},&quot;shareTexts&quot;:{},&quot;answers&quot;:{&quot;voters&quot;:{},&quot;copyrightApplicants&quot;:{},&quot;favlists&quot;:{},&quot;newAnswer&quot;:{}},&quot;banner&quot;:{},&quot;topics&quot;:{&quot;bios&quot;:{}},&quot;captcha&quot;:{&quot;captchaNeeded&quot;:false,&quot;captchaBase64String&quot;:null,&quot;captchaValidationMessage&quot;:null,&quot;loginCaptchaExpires&quot;:false},&quot;sms&quot;:{&quot;supportedCountries&quot;:[]},&quot;explore&quot;:{&quot;recommendations&quot;:{},&quot;hotfeeds&quot;:{}},&quot;articles&quot;:{&quot;voters&quot;:{}},&quot;favlists&quot;:{&quot;relations&quot;:{}},&quot;pins&quot;:{&quot;voters&quot;:{}},&quot;topstory&quot;:{&quot;topstorys&quot;:{&quot;isFetching&quot;:false,&quot;isDrained&quot;:false,&quot;afterId&quot;:0,&quot;items&quot;:[],&quot;next&quot;:null},&quot;sidebar&quot;:null},&quot;upload&quot;:{},&quot;video&quot;:{&quot;data&quot;:{}},&quot;guide&quot;:{&quot;guide&quot;:{&quot;isFetching&quot;:false,&quot;isShowGuide&quot;:false}},&quot;switches&quot;:{},&quot;coupon&quot;:{&quot;isRedeemingCoupon&quot;:false},&quot;reward&quot;:{}}" data-config="{&quot;apiAddress&quot;:&quot;/api/v4/&quot;,&quot;deployEnv&quot;:&quot;production&quot;}" data-reactid="20"></div><script src="https://static.zhihu.com/heifetz/vendor.1f389462803af519e7ae.js" data-reactid="21"></script><script src="https://static.zhihu.com/heifetz/main.raven.642b48d692cbac26e95a.js" async="" data-reactid="22"></script><script src="https://static.zhihu.com/heifetz/main.app.659a05d4f8068d96bb7e.js" data-reactid="23"></script></body></html>